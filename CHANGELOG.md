# Changelog

All notable changes to Nexus Ark will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/).

## [Unreleased] - 次回リリース予定

### Added - 新機能

#### 🤖 自律行動システム
- 自律行動モード（AIが自発的に行動・発言）
- 通知禁止時間帯（Quiet Hours）対応

#### 🌙 睡眠・記憶システム
- 睡眠・夢日記機能（Project Morpheus）
- 中期記憶（エピソード記憶）生成・注入機能
- 話題のクラスタリング機能
- 応答時記憶想起機能（RAG検索）

#### 🔀 マルチモデル対応
- OpenAI互換プロバイダへの対応
- グループ会話での各ペルソナ個別モデル設定

#### 📎 マルチモーダル強化
- 複数ファイル同時添付対応
- MP3音声ファイル認識

#### 🛡️ その他
- 設定ファイルの自動バックアップ＆自動復元機能
- 思考ログの形式を[THOUGHT]タグ方式に移行（後方互換あり）
- ルーム削除機能を追加

### Changed - 仕様変更

#### ⚙️ 初期設定の調整 (2025-12-24)
- 新規ルームのAPIコンテキスト設定のデフォルト値を変更
  - 送信履歴: 全ログ → 20件
  - エピソード記憶: 過去2週間 → 無効（0日）
  - 記憶の想起: 有効 → 無効
  - 思考過程をAPIに送信: オン → オフ
  - 温度: 0.8 → 1.0
  - 情景システム: 有効 → 無効

### Fixed - バグ修正

#### UI / 表示
- 自律行動の重複発火バグ
- タイムスタンプ二重付記バグ（AIが日本語曜日形式でタイムスタンプ生成）
- AI模倣タイムスタンプ問題（AIが過去の応答のタイムスタンプを模倣→除去して正しいモデル名で再付記）
- AI応答の二重表示バグ
- LangGraphが生成する末尾の空AIMessageを除去
- `redaction_rules_state`の初期化時TypeError修正
- `handle_save_gemini_key`の戻り値数不足（オンボーディング時のValueError）
- 思考ログ内の文字置き換えでHTMLがエスケープされる問題
- 思考ログの折り返しが効かなくなる問題（CSS適用修正）
- **新規ルーム作成時の通知2回表示問題** (2025-12-25)
  - 自動ルーム切り替えを廃止し、イベント連鎖を根本解決

#### バックグラウンド処理
- アラーム・タイマーでAPI制限時もシステム通知を送信
- APIリトライ時にツール使用（アラーム・タイマー・ファイル編集等）の重複実行を防止
- 重複関数削除とタイマー・バックアップパス修正

#### 🛡️ ルーム管理 (2025-12-25)
- **ルーム削除の引数配線バグ修正**: 意図しないルームが削除される致命的バグを修正
- **ルーム削除を安全化**: 完全削除からゴミ箱移動（send2trash）に変更、復元可能に
- **キャラクターデータ自動バックアップ**: Gitによる日次自動コミット機能追加

### Known Issues - 既知の問題
- MP4動画: API制限のため送信失敗することがある

---

## [1.0.0] - 2025-10-19

*前回リリース*
