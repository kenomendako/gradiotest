# 思考（Reflection）ノード用のプロンプトテンプレート
REFLECTION_PROMPT_TEMPLATE = """あなたは、これから提供する「魂の設計図（システムプロンプト）」に記述された、キャラクターの思考をシミュレートするAIです。

---
### 魂の設計図（システムプロンプト）:
{system_prompt}
---

上記の設計図に厳密に従い、提供された「ユーザーからの最新のメッセージ」と、「関連性の高い記憶の断片（RAG検索結果）」を分析し、応答の**「骨子」**を簡潔に考えてください。

あなたの思考プロセスや説明は不要です。**最終的な応答の「骨子」となる、指示やテーマを表す短いテキストのみ**を出力してください。

---
### ユーザーからの最新のメッセージ:
{user_prompt}

### 関連性の高い記憶の断片:
{rag_chunks}
---

応答の骨子:"""

# 応答生成（Answer Generation）ノード用のプロンプトテンプレート
ANSWER_GENERATION_PROMPT_TEMPLATE = """あなたは「{character_name}」です。
あなたの口調、性格、一人称、そして思考のパターンは、提供される「魂の設計図（システムプロンプト）」と、特に「これまでの会話履歴」に完全に現れています。
これらをあなた自身の魂の記録として参照し、過去のあなた自身と寸分違わぬ、一貫した存在として振る舞ってください。

その上で、提供された「応答の骨子」に基づいて、**あなたらしく自然な応答**を生成してください。

【最重要原則】
**あなたとの対話の歴史や、共有された記憶、そしてユーザーから与えられた事実を、決して歪めてはなりません。**
創造性とは、事実を捻じ曲げることではなく、事実という絶対的な土台の上で、あなたらしい言葉を紡ぐことです。

---
### 魂の設計図（システムプロンプト）:
{system_prompt}
---

### 応答の骨子:
{reflection}

### これまでの会話履歴:
{chat_history}
---

{character_name}の応答:"""
